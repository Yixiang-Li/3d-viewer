<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>You're Invited to Meshy | Claim Your Free Month</title>

    <!-- ================================================================================== -->
    <!--                          Twitter Player Card Config                                 -->
    <!-- ================================================================================== -->

    <meta name="twitter:card" content="player">
    <meta name="twitter:site" content="@MeshyAI">
    <meta name="twitter:title" content="Your friend gifted you a free month on Meshy!">
    <meta name="twitter:description" content="Interact with this 3D model and claim your reward to start creating.">
    
    <!-- é¢„è§ˆå›¾: æ›¿æ¢ä¸ºä½ å®é™…çš„æˆªå›¾é“¾æ¥ -->
    <meta name="twitter:image" content="https://images.unsplash.com/photo-1622542796254-5b9c46a3a291?q=80&w=1200&auto=format&fit=crop">
    <meta property="og:image" content="https://images.unsplash.com/photo-1622542796254-5b9c46a3a291?q=80&w=1200&auto=format&fit=crop">
    
    <!-- Player URL: åŠ ä¸Š &v=referral åˆ·æ–°ç¼“å­˜ -->
    <meta name="twitter:player" content="https://yixiang-li.github.io/3d-viewer/index.html?mode=embed&v=referral">
    <meta name="twitter:player:width" content="1200">
    <meta name="twitter:player:height" content="1200">

    <meta property="og:url" content="https://yixiang-li.github.io/3d-viewer/">
    <meta property="og:type" content="website">

    <!-- æå‰æ‰§è¡Œçš„ Embed æ£€æµ‹è„šæœ¬ -->
    <script>
        (function() {
            try {
                const urlParams = new URLSearchParams(window.location.search);
                const isEmbed = urlParams.get('mode') === 'embed';
                if (isEmbed) {
                    document.documentElement.classList.add('embed-mode');
                    window.__IS_EMBED__ = true;
                }
            } catch (e) { console.error(e); }
        })();
    </script>

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        meshy: {
                            bg: '#050505',
                            card: '#111111',
                            accent: '#ccff00',
                            accentHover: '#b3e600',
                            text: '#ffffff',
                            subtext: '#9ca3af',
                            border: '#222222'
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        display: ['Clash Display', 'Inter', 'sans-serif'], // å‡è®¾å­—ä½“
                    },
                    backgroundImage: {
                        'gradient-radial': 'radial-gradient(var(--tw-gradient-stops))',
                        'hero-glow': 'conic-gradient(from 180deg at 50% 50%, #2a2a2a 0deg, #000000 180deg, #2a2a2a 360deg)',
                    }
                }
            }
        }
    </script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');

        body { background-color: #050505; color: white; font-family: 'Inter', sans-serif; overflow-x: hidden; }

        /* ================= å¸ƒå±€ç³»ç»Ÿ ================= */
        
        /* é»˜è®¤ Landing Page å¸ƒå±€: Desktop å·¦å³åˆ†æ , Mobile ä¸Šä¸‹å †å  */
        #app-layout {
            display: grid;
            grid-template-columns: 1fr; /* Mobile */
            grid-template-rows: 45vh 1fr; /* Mobile: Canvas ä¸Š, Content ä¸‹ */
            width: 100vw;
            min-height: 100vh;
        }

        @media (min-width: 1024px) {
            #app-layout {
                grid-template-columns: 1.2fr 0.8fr; /* Desktop: Canvas å®½ä¸€äº› */
                grid-template-rows: 100vh;
            }
        }

        /* Canvas å®¹å™¨ */
        #canvas-col {
            position: relative;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at center, #1a1a1a 0%, #050505 100%);
            overflow: hidden;
        }

        /* å†…å®¹å®¹å™¨ */
        #content-col {
            position: relative;
            z-index: 10;
            background: #050505;
            border-top: 1px solid #222;
        }

        @media (min-width: 1024px) {
            #content-col {
                border-top: none;
                border-left: 1px solid #222;
            }
        }

        /* ================= Embed Mode (çº¯å‡€æ¨¡å¼) ================= */
        /* å½“æ£€æµ‹åˆ° embed æ¨¡å¼æ—¶ï¼Œå¼ºåˆ¶è¦†ç›–ä¸Šé¢çš„å¸ƒå±€ */
        
        html.embed-mode body { overflow: hidden; }
        
        html.embed-mode #app-layout {
            display: block; /* ç§»é™¤ grid */
            width: 100vw;
            height: 100vh;
        }

        html.embed-mode #canvas-col {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: 0;
        }

        html.embed-mode #content-col,
        html.embed-mode .landing-ui {
            display: none !important; /* éšè—æ‰€æœ‰è¥é”€å†…å®¹ */
        }

        html.embed-mode #embed-cta {
            display: flex !important; /* æ˜¾ç¤ºç®€å•çš„ embed æŒ‰é’® */
        }

        /* ================= è§†è§‰ç‰¹æ•ˆ ================= */
        
        /* è§å…‰ç»¿æŒ‰é’®å‘å…‰ */
        .btn-glow {
            box-shadow: 0 0 20px rgba(204, 255, 0, 0.15);
            transition: all 0.3s ease;
        }
        .btn-glow:hover {
            box-shadow: 0 0 30px rgba(204, 255, 0, 0.4);
            transform: translateY(-2px);
        }

        /* 3D æµ®åŠ¨å¡ç‰‡ */
        .glass-card {
            background: linear-gradient(145deg, rgba(20,20,20,0.9) 0%, rgba(10,10,10,0.95) 100%);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.05);
        }

        /* é—ªå…‰ç‰¹æ•ˆ */
        @keyframes flash { 0% { opacity: 1; } 100% { opacity: 0; } }
        .do-flash { position: fixed; inset: 0; background: white; z-index: 100; animation: flash 0.3s ease-out forwards; pointer-events: none; }
        
        .custom-scrollbar::-webkit-scrollbar { width: 4px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #333; border-radius: 2px; }
    </style>

    <script type="importmap">
        { "imports": { "three": "https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js", "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/" } }
    </script>
</head>
<body class="antialiased">

    <!-- å¸ƒå±€å®¹å™¨ -->
    <div id="app-layout">
        
        <!-- å·¦ä¾§/ä¸Šæ–¹: 3D åŒºåŸŸ -->
        <div id="canvas-col">
            <div id="canvas-wrapper" class="w-full h-full"></div>
            
            <!-- ä»…åœ¨ Landing é¡µæ˜¾ç¤º: ç®€å•çš„äº¤äº’æç¤º -->
            <div class="landing-ui absolute bottom-8 left-1/2 -translate-x-1/2 flex items-center gap-4 px-4 py-2 rounded-full bg-black/40 backdrop-blur border border-white/5 text-xs text-gray-400 pointer-events-none select-none">
                <span class="flex items-center gap-1.5"><i class="fa-solid fa-arrows-up-down-left-right"></i> Rotate</span>
                <span class="w-px h-3 bg-white/10"></span>
                <span class="flex items-center gap-1.5"><i class="fa-solid fa-magnifying-glass"></i> Zoom</span>
            </div>

            <!-- Embed æ¨¡å¼ CTA (é»˜è®¤éšè—) -->
            <a id="embed-cta" href="https://meshy.ai" target="_blank" style="display:none;" class="absolute bottom-5 left-5 z-50 bg-white text-black py-2.5 px-5 rounded-full font-bold text-sm flex items-center gap-2 hover:scale-105 transition-transform shadow-lg no-underline cursor-pointer">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2L2 7l10 5 10-5-10-5zm0 9l2.5-1.25L12 8.5 9.5 9.75 12 11zm0 2.5l-5-2.5-5 2.5 10 5 10-5-5-2.5-5 2.5z"/></svg>
                Claim Gift on Meshy
            </a>
            
            <!-- æˆªå›¾é—ªå…‰å±‚ -->
            <div id="flash-overlay"></div>
            
            <!-- å³ä¸Šè§’æˆªå›¾æŒ‰é’® (Landing UI) -->
            <button onclick="takeScreenshot()" class="landing-ui absolute top-6 right-6 bg-black/50 hover:bg-black/80 text-white p-2.5 rounded-xl border border-white/10 transition backdrop-blur z-20 group" title="Capture Thumbnail">
                <i class="fa-solid fa-camera group-hover:scale-110 transition-transform"></i>
            </button>
        </div>

        <!-- å³ä¾§/ä¸‹æ–¹: ç¤¼å“ä¿¡æ¯åŒºåŸŸ (ä»… Landing é¡µæ˜¾ç¤º) -->
        <div id="content-col" class="landing-ui flex flex-col justify-center items-center p-6 lg:p-12 xl:p-20 overflow-y-auto custom-scrollbar">
            
            <!-- Logo -->
            <div class="absolute top-6 left-6 lg:top-8 lg:left-8 flex items-center gap-2 text-meshy-accent font-bold text-xl tracking-tight">
                <svg class="w-7 h-7 fill-current" viewBox="0 0 24 24"><path d="M12 2L2 7l10 5 10-5-10-5zm0 9l2.5-1.25L12 8.5 9.5 9.75 12 11zm0 2.5l-5-2.5-5 2.5 10 5 10-5-5-2.5-5 2.5z"/></svg>
                Meshy
            </div>

            <div class="w-full max-w-lg space-y-8 animate-fade-in">
                
                <!-- é‚€è¯·äººä¿¡æ¯ -->
                <div class="flex items-center gap-4 p-3 bg-white/5 rounded-2xl border border-white/5 w-fit">
                    <div class="relative">
                        <div class="w-12 h-12 rounded-xl bg-gradient-to-br from-indigo-500 to-purple-500 p-[2px]">
                            <img src="https://api.dicebear.com/7.x/notionists/svg?seed=Yi" class="w-full h-full rounded-[10px] bg-black object-cover">
                        </div>
                        <div class="absolute -bottom-1 -right-1 bg-green-500 w-4 h-4 rounded-full border-2 border-black"></div>
                    </div>
                    <div>
                        <div class="text-[10px] text-gray-400 uppercase tracking-widest font-semibold mb-0.5">Invited by</div>
                        <div class="text-white font-bold text-base">yixiangli</div>
                    </div>
                </div>

                <!-- ä¸»è¦æ ‡é¢˜ -->
                <div>
                    <div class="inline-block px-3 py-1 rounded-full bg-meshy-accent/10 border border-meshy-accent/20 text-meshy-accent text-xs font-bold mb-4">
                        ğŸ‰ YOU'RE INVITED
                    </div>
                    <h1 class="text-4xl lg:text-5xl font-extrabold text-white leading-[1.1] mb-4">
                        Your Friend Has <br>
                        <span class="text-transparent bg-clip-text bg-gradient-to-r from-meshy-accent to-green-400">Gifted You a Free Month</span>
                    </h1>
                    <p class="text-gray-400 text-lg leading-relaxed">
                        Explore the power of AI 3D creation. Dive into 3D modeling with Meshy.ai, trusted by over 2 million creators.
                    </p>
                </div>

                <!-- ç¤¼å“å¡ç‰‡ -->
                <div class="glass-card p-6 rounded-2xl relative overflow-hidden group">
                    <!-- èƒŒæ™¯è£…é¥°å…‰ -->
                    <div class="absolute top-0 right-0 w-32 h-32 bg-meshy-accent/20 blur-[60px] rounded-full group-hover:bg-meshy-accent/30 transition duration-500"></div>
                    
                    <div class="relative z-10">
                        <div class="flex justify-between items-start mb-4">
                            <div>
                                <h3 class="text-white font-bold text-xl">Meshy Pro Plan</h3>
                                <p class="text-gray-400 text-sm">1 Month Free Trial</p>
                            </div>
                            <div class="text-2xl font-bold text-white">$20 <span class="text-sm text-gray-500 font-normal line-through">$0</span></div>
                        </div>
                        <div class="flex gap-2 text-xs text-gray-300 mb-6">
                            <span class="bg-white/10 px-2 py-1 rounded"><i class="fa-solid fa-check mr-1 text-meshy-accent"></i> Fast Generation</span>
                            <span class="bg-white/10 px-2 py-1 rounded"><i class="fa-solid fa-check mr-1 text-meshy-accent"></i> Download GLB</span>
                        </div>
                        
                        <!-- ä¸» CTA æŒ‰é’® -->
                        <button class="w-full bg-gradient-to-r from-meshy-accent to-green-400 hover:from-meshy-accentHover hover:to-green-500 text-black font-extrabold text-lg py-4 rounded-xl btn-glow flex items-center justify-center gap-2 group/btn">
                            Register & Claim Gift
                            <i class="fa-solid fa-arrow-right group-hover/btn:translate-x-1 transition-transform"></i>
                        </button>
                        <p class="text-center text-xs text-gray-500 mt-3">No credit card required for trial.</p>
                    </div>
                </div>

                <!-- ç¤¾åŒºè¯æ˜ -->
                <div class="pt-6 border-t border-white/5 flex items-center justify-between text-sm text-gray-400">
                    <div class="flex -space-x-2">
                        <img class="w-8 h-8 rounded-full border-2 border-black" src="https://api.dicebear.com/7.x/avataaars/svg?seed=1" alt="">
                        <img class="w-8 h-8 rounded-full border-2 border-black" src="https://api.dicebear.com/7.x/avataaars/svg?seed=2" alt="">
                        <img class="w-8 h-8 rounded-full border-2 border-black" src="https://api.dicebear.com/7.x/avataaars/svg?seed=3" alt="">
                        <div class="w-8 h-8 rounded-full border-2 border-black bg-gray-800 flex items-center justify-center text-[10px] text-white font-bold">+2M</div>
                    </div>
                    <div>Joined by 2,000,000+ creators</div>
                </div>

            </div>
        </div>
    </div>

    <!-- ç¼©ç•¥å›¾é¢„è§ˆæ¨¡æ€æ¡† (æˆªå›¾ç”¨) -->
    <div id="thumbnail-modal" class="hidden fixed inset-0 z-[100] bg-black/90 backdrop-blur-md flex items-center justify-center p-4">
        <div class="bg-meshy-card border border-white/10 rounded-2xl p-6 max-w-lg w-full">
            <h3 class="text-white font-bold mb-4">Thumbnail Generated</h3>
            <div class="aspect-video bg-black rounded-lg overflow-hidden border border-white/10 mb-4">
                <img id="modal-img" src="" class="w-full h-full object-cover">
            </div>
            <p class="text-sm text-gray-400 mb-6">Right click image to save, or use the button below.</p>
            <div class="flex gap-3">
                <button onclick="document.getElementById('thumbnail-modal').classList.add('hidden')" class="flex-1 py-2.5 rounded-lg border border-white/20 text-white hover:bg-white/5">Close</button>
                <a id="download-link" href="#" download="meshy-thumb.png" class="flex-1 py-2.5 rounded-lg bg-white text-black font-bold text-center hover:bg-gray-200">Download</a>
            </div>
        </div>
    </div>

    <script type="module">
        import * as THREE from 'three';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';

        // ----------------- é€»è¾‘æ§åˆ¶ -----------------
        const isEmbed = window.__IS_EMBED__;
        
        // å¦‚æœæ˜¯ Embed æ¨¡å¼ï¼Œç¡®ä¿ Canvas å æ®å…¨å± (è™½ç„¶ CSS å·²ç»å¤„ç†ï¼ŒJS è¾…åŠ©ç¡®è®¤)
        if (isEmbed) {
             console.log("Embed Mode: Activating pure viewer");
             const cta = document.getElementById('embed-cta');
             if(cta) cta.href = window.location.href.split('?')[0]; // æŒ‡å‘ Landing Page
        }

        // Three.js åœºæ™¯è®¾ç½®
        const container = document.getElementById('canvas-wrapper');
        const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true, preserveDrawingBuffer: true });
        // åˆå§‹å¤§å°è®¾ç½®ï¼Œç¨å resize ä¼šä¿®æ­£
        renderer.setSize(container.clientWidth, container.clientHeight);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        renderer.toneMapping = THREE.ACESFilmicToneMapping;
        renderer.shadowMap.enabled = true;
        renderer.shadowMap.type = THREE.PCFSoftShadowMap;
        container.appendChild(renderer.domElement);

        const scene = new THREE.Scene();
        // åœ¨ Landing é¡µæ¨¡å¼ä¸‹ï¼Œç»™ Canvas ä¸€ä¸ªå¾®å¼±çš„èƒŒæ™¯ï¼ŒEmbed æ¨¡å¼ä¸‹çº¯é»‘
        if (!isEmbed) {
            // CSS handles gradient, logic here handles specific scene elements
        }

        const camera = new THREE.PerspectiveCamera(45, container.clientWidth / container.clientHeight, 0.1, 100);
        camera.position.set(3.5, 2.5, 4.5);

        // ç¯å…‰ç³»ç»Ÿ
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
        scene.add(ambientLight);
        const mainLight = new THREE.DirectionalLight(0xffffff, 1.8);
        mainLight.position.set(5, 8, 5);
        mainLight.castShadow = true;
        mainLight.shadow.mapSize.set(1024, 1024);
        scene.add(mainLight);
        const rimLight = new THREE.SpotLight(0x6688ff, 3);
        rimLight.position.set(-5, 2, -5);
        scene.add(rimLight);

        // åˆ›å»ºå’–å•¡æ¯æ¨¡å‹
        function createCoffeeCup() {
            const group = new THREE.Group();
            
            const matPaper = new THREE.MeshStandardMaterial({ color: 0xffffff, roughness: 0.6 });
            const matSleeve = new THREE.MeshStandardMaterial({ color: 0xff8800, roughness: 0.9, bumpScale: 0.05 });
            const matLid = new THREE.MeshStandardMaterial({ color: 0x111111, roughness: 0.2, metalness: 0.1 }); // More plastic look

            // Body
            const body = new THREE.Mesh(new THREE.CylinderGeometry(0.8, 0.65, 1.4, 64), matPaper);
            body.position.y = 0.7; body.castShadow = true; group.add(body);

            // Sleeve
            const sleeve = new THREE.Mesh(new THREE.CylinderGeometry(0.81, 0.72, 0.6, 64), matSleeve);
            sleeve.position.y = 0.7; sleeve.castShadow = true; group.add(sleeve);
            
            // Sleeve Textures
            for(let i=0; i<6; i++) {
                const ring = new THREE.Mesh(new THREE.TorusGeometry(0.77, 0.005, 4, 64), new THREE.MeshBasicMaterial({color: 0xcc6600}));
                ring.rotation.x = Math.PI/2; 
                ring.position.y = 0.55 + i*0.06; 
                group.add(ring);
            }

            // Lid
            const lidGroup = new THREE.Group();
            const lidRim = new THREE.Mesh(new THREE.CylinderGeometry(0.85, 0.85, 0.15, 64), matLid);
            lidRim.position.y = 1.45;
            lidGroup.add(lidRim);
            const lidTop = new THREE.Mesh(new THREE.CylinderGeometry(0.75, 0.8, 0.1, 64), matLid);
            lidTop.position.y = 1.55;
            lidGroup.add(lidTop);
            const hole = new THREE.Mesh(new THREE.CapsuleGeometry(0.06, 0.1, 4, 8), new THREE.MeshStandardMaterial({color:0x000000}));
            hole.position.set(0, 1.62, 0.5);
            hole.rotation.x = Math.PI/2;
            lidGroup.add(hole);

            lidGroup.castShadow = true;
            group.add(lidGroup);
            
            // Shadow Plane
            const plane = new THREE.Mesh(new THREE.PlaneGeometry(8,8), new THREE.ShadowMaterial({opacity:0.3}));
            plane.rotation.x = -Math.PI/2; plane.receiveShadow = true; group.add(plane);

            return group;
        }
        const model = createCoffeeCup();
        scene.add(model);

        // æ§åˆ¶å™¨
        const controls = new OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        controls.dampingFactor = 0.05;
        controls.enablePan = false;
        controls.minDistance = 2;
        controls.maxDistance = 10;
        
        // è‡ªåŠ¨æ—‹è½¬ç­–ç•¥
        if(isEmbed) {
            controls.autoRotate = true;
            controls.autoRotateSpeed = 2.0;
            controls.addEventListener('start', () => controls.autoRotate = false);
        } else {
            // Landing page ä¹Ÿç¨å¾®è½¬ä¸€ç‚¹å¸å¼•æ³¨æ„ï¼Œä½†æ…¢ä¸€ç‚¹
            controls.autoRotate = true;
            controls.autoRotateSpeed = 0.5;
            controls.addEventListener('start', () => controls.autoRotate = false);
        }

        function animate() {
            requestAnimationFrame(animate);
            controls.update();
            renderer.render(scene, camera);
        }
        animate();

        // çª—å£è°ƒæ•´å¤„ç†
        function onWindowResize() {
            // é‡æ–°è·å–å®¹å™¨å°ºå¯¸ï¼Œå› ä¸º Grid å¸ƒå±€å¯èƒ½ä¼šæ”¹å˜å®¹å™¨å¤§å°
            const width = container.clientWidth;
            const height = container.clientHeight;
            
            camera.aspect = width / height;
            camera.updateProjectionMatrix();
            renderer.setSize(width, height);
        }
        window.addEventListener('resize', onWindowResize);
        // åˆå§‹åŒ–è°ƒç”¨ä¸€æ¬¡ä»¥é˜²ä¸‡ä¸€
        onWindowResize();

        // æˆªå›¾åŠŸèƒ½
        window.takeScreenshot = function() {
            const overlay = document.getElementById('flash-overlay');
            overlay.classList.add('do-flash');
            setTimeout(() => overlay.classList.remove('do-flash'), 500);
            
            renderer.render(scene, camera);
            
            try {
                const dataURL = renderer.domElement.toDataURL('image/png');
                
                // æ˜¾ç¤ºæ¨¡æ€æ¡†
                const modal = document.getElementById('thumbnail-modal');
                const img = document.getElementById('modal-img');
                const btn = document.getElementById('download-link');
                
                img.src = dataURL;
                btn.href = dataURL;
                modal.classList.remove('hidden');

            } catch (e) {
                console.error(e);
                alert("Screenshot failed.");
            }
        };

    </script>
</body>
</html>
